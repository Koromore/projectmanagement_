webpackJsonp([1],{C16p:function(s,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={name:"task",data:function(){return{loading:!0,loginState:!0,project_style:"",drawer:!1,client_list:[{value:"广汽本田",label:"广汽本田"},{value:"吉利",label:"吉利"},{value:"沃尔沃",label:"沃尔沃"}],client:"广汽本田",businessList:[],clientList:[],clientListPageData:{},tabs_activity:1,operation:1,transferId:"",disabled:!1,addBut:"opacity: 1;",new_name:"",businessListCheck:[],businessPage:{},clientPage:0,businessListPageNum:1,clientListPageNum:1}},methods:{widthheight:function(){window.innerWidth,window.innerHeight},test:function(s,t){},drawer_show:function(){this.drawer=!0},table_tab:function(s){this.tabs_activity=s,1==s?(this.disabled=!1,this.addBut="opacity: 1;"):2==s&&(this.disabled=!0,this.addBut="opacity: 0;")},getBusinessListAjax:function(s){this.loading=!0,void 0==s&&(s={}),this.$axios.post("/pmbs/api/business/listAjax",s).then(this.getBusinessListAjaxSuss)},getBusinessListAjaxSuss:function(s){this.loading=!1,200==s.status&&(this.businessList=s.data.data.items,this.businessPage=s.data.data)},getClientListAjax:function(s){this.loading=!0,void 0==s&&(s={}),this.$axios.post("http://pms.guoxinad.com.cn/pas/clientapi/allListAjax",s).then(this.getClientListAjaxSuss)},getClientListAjaxSuss:function(s){if(this.loading=!1,200==s.status){var t=s.data,e=[],i={page1:[],page2:[],page3:[],page4:[],page5:[],page6:[],page7:[],page8:[],page9:[]};t.forEach(function(s,t){var a={clientId:s.clientId,clientName:s.clientName,businessList:[]};e.push(a),t<=9?i.page1.push(a):t>9&&t<=19?i.page2.push(a):t>19&&t<=29?i.page3.push(a):t>29&&t<=39?i.page4.push(a):t>39&&t<=49?i.page5.push(a):t>49&&t<=59?i.page6.push(a):t>59&&t<=69&&i.page7.push(a)}),this.clientPage=t.length,this.clientListPageData=i;var a={clientList:i.page1};this.getBusinessByClientIds(a)}},getBusinessByClientIds:function(s){this.loading=!0,void 0==s&&(s={}),this.$axios.post("/pmbs/api/business/getBusinessByClientIds",s).then(this.getBusinessByClientIdsSuss)},getBusinessByClientIdsSuss:function(s){if(this.loading=!1,200==s.status){var t=s.data;this.clientList=t}},add_drawer:function(){this.drawer=!0,this.operation=1,this.transferId="",this.new_name=name,this.businessListCheck=[]},business_change:function(s,t){this.drawer=!0,this.operation=2,this.transferId=s,this.new_name=t},client_change:function(s){this.drawer=!0,this.operation=2,this.transferId=s.clientId,this.new_name=s.clientName;for(var t=[],e=0;e<s.businessList.length;e++){var i=s.businessList[e];t.push(i.businessId)}this.businessListCheck=t},putIn:function(){this.drawer=!1;var s=this.tabs_activity,t={};if(1==s)""==(t={businessId:this.transferId,businessName:this.new_name}).businessName?this.messageError("信息不能为空"):this.businessSave(t);else if(2==s){for(var e=[],i=this.businessList,a=this.businessListCheck,n=[],l=0;l<a.length;l++){for(var u=a[l],r={},o=0;o<i.length;o++){i[o];u==i[o].businessId&&(n.push(i[o].businessName),r.businessId=u,r.businessName=i[o].businessName)}r.businessId&&e.push(r)}""==(t={clientId:this.transferId,businessList:e}).clientName||0==t.businessList.length?this.messageError("信息不能为空"):this.clientSave(t)}},businessSave:function(s){var t=s;this.loading=!0,this.$axios.post("/pmbs/api/business/save",t).then(this.businessSaveSuss)},businessSaveSuss:function(s){if(200==s.status){var t=this.businessListPageNum,e={clientList:this.clientListPageData["page"+t]},i={pageNum:this.clientListPageNum};this.getBusinessByClientIds(e),this.getBusinessListAjax(i),this.messageWin(s.data.msg),this.transferId="",this.new_name="",this.drawer=!1,this.loading=!1}},clientSave:function(s){var t=s;this.loading=!0,this.$axios.post("/pmbs/client/save",t).then(this.clientSaveSuss)},clientSaveSuss:function(s){if(200==s.status){var t={clientList:this.clientListPageData["page"+this.clientListPageNum]};this.getBusinessByClientIds(t),this.messageWin(s.data.msg),this.transferId="",this.new_name="",this.businessListCheck=[],this.drawer=!1,this.loading=!1}},delete_but:function(s){var t=this.tabs_activity,e={};1==t?(e=s,this.businessDelete(e)):2==t&&(e=s,this.clientDelete(e))},businessDelete:function(s){var t="?id="+s;this.$axios.post("/pmbs/api/business/delete"+t).then(this.businessDeleteSuss)},businessDeleteSuss:function(s){if(200==s.status){var t={pageNum:this.businessListPageNum};this.getBusinessListAjax(t),this.messageWin(s.data.msg)}},businessListPage:function(s){this.businessListPageNum=s;var t={pageNum:s};this.getBusinessListAjax(t)},clientListPage:function(s){this.clientListPageNum=s;var t={clientList:this.clientListPageData["page"+s]};this.getBusinessByClientIds(t)},messageWin:function(s){this.$message({message:s,type:"success"})},messageError:function(s){this.$message.error(s)}},mounted:function(){this.getBusinessListAjax(),this.getClientListAjax()}},a={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"set",style:s.project_style},[e("el-row",[e("el-col",{staticClass:"tabs",attrs:{span:24}},[e("div",{class:[1==s.tabs_activity?"act":""],on:{click:function(t){return s.table_tab(1)}}},[s._v("业务类型")]),s._v(" "),e("div",{class:[2==s.tabs_activity?"act":""],on:{click:function(t){return s.table_tab(2)}}},[s._v("客户")])]),s._v(" "),e("el-col",{staticClass:"add",style:s.addBut,attrs:{span:24}},[e("el-button",{style:s.addBut,attrs:{size:"small",type:"primary",disabled:s.disabled},on:{click:function(t){return s.add_drawer()}}},[s._v("新增")])],1),s._v(" "),e("el-col",{directives:[{name:"show",rawName:"v-show",value:1==s.tabs_activity,expression:"tabs_activity==1"}],staticClass:"table table1",attrs:{span:24}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:s.loading,expression:"loading"}],ref:"filterTable",staticStyle:{width:"100%"},attrs:{data:s.businessList,"header-cell-style":{background:"rgb(236, 235, 235)",color:"#000"},"row-style":{height:"57px"}}},[e("el-table-column",{attrs:{prop:"businessName",label:"名称"}}),s._v(" "),e("el-table-column",{attrs:{prop:"tag",label:"操作",width:"210","filter-placement":"bottom-end"},scopedSlots:s._u([{key:"default",fn:function(t){return[e("el-button",{attrs:{size:"small",type:"info"},on:{click:function(e){return s.business_change(t.row.businessId,t.row.businessName)}}},[s._v("修改")]),s._v(" "),e("el-popconfirm",{attrs:{title:"确认执行此操作吗？"},on:{onConfirm:function(e){return s.delete_but(t.row.businessId)}}},[e("el-button",{attrs:{slot:"reference",size:"small",type:"primary"},slot:"reference"},[s._v("删除")])],1)]}}])})],1),s._v(" "),e("el-col",{staticClass:"page",attrs:{span:24}},[e("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next",total:s.businessPage.totalRows},on:{"current-change":s.businessListPage}})],1)],1),s._v(" "),e("el-col",{directives:[{name:"show",rawName:"v-show",value:2==s.tabs_activity,expression:"tabs_activity==2"}],staticClass:"table table2",attrs:{span:24}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:s.loading,expression:"loading"}],ref:"filterTable",staticStyle:{width:"100%"},attrs:{data:s.clientList,"header-cell-style":{background:"rgb(236, 235, 235)",color:"#000"},"row-style":{height:"57px"}}},[e("el-table-column",{attrs:{prop:"clientName",label:"客户"}}),s._v(" "),e("el-table-column",{attrs:{prop:"businessList",label:"业务"},scopedSlots:s._u([{key:"default",fn:function(t){return s._l(t.row.businessList,function(t,i){return null!=t?e("span",{key:i},[0!=i?e("span",[s._v("、")]):s._e(),s._v("\n              "+s._s(t.businessName)+"\n            ")]):s._e()})}}])}),s._v(" "),e("el-table-column",{attrs:{prop:"tag",label:"操作",width:"210","filter-placement":"bottom-end"},scopedSlots:s._u([{key:"default",fn:function(t){return[e("el-button",{attrs:{size:"small",type:"info"},on:{click:function(e){return s.client_change(t.row)}}},[s._v("修改")])]}}])})],1),s._v(" "),e("el-col",{staticClass:"page",attrs:{span:24}},[e("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next",total:s.clientPage},on:{"current-change":s.clientListPage}})],1)],1)],1),s._v(" "),e("el-drawer",{attrs:{title:"新增",visible:s.drawer,"with-header":!1},on:{"update:visible":function(t){s.drawer=t}}},[e("el-row",{staticClass:"add_box"},[e("el-col",{staticClass:"new_name",attrs:{span:24}},[e("el-col",{staticClass:"title title1",attrs:{span:6}},[s._v("名称")]),s._v(" "),e("el-col",{attrs:{span:13}},[e("el-input",{attrs:{placeholder:"请输入内容",clearable:"",disabled:s.disabled},model:{value:s.new_name,callback:function(t){s.new_name=t},expression:"new_name"}})],1),s._v(" "),e("el-col",{directives:[{name:"show",rawName:"v-show",value:2==s.tabs_activity,expression:"tabs_activity == 2"}],staticClass:"title title2",attrs:{span:6}},[s._v("业务")]),s._v(" "),e("el-col",{directives:[{name:"show",rawName:"v-show",value:2==s.tabs_activity,expression:"tabs_activity == 2"}],staticClass:"check_box",attrs:{span:13,offset:6}},[e("el-checkbox-group",{model:{value:s.businessListCheck,callback:function(t){s.businessListCheck=t},expression:"businessListCheck"}},s._l(s.businessList,function(t){return e("el-checkbox",{key:t.index,attrs:{label:t.businessId}},[s._v(s._s(t.businessName))])}),1)],1)],1),s._v(" "),e("el-col",{staticClass:"batton",attrs:{span:12,offset:7}},[e("el-button",{attrs:{size:"small",type:"info"}},[s._v("取消")]),s._v(" "),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:s.putIn}},[s._v("提交")])],1)],1)],1)],1)},staticRenderFns:[]};var n=e("VU/8")(i,a,!1,function(s){e("UKAY")},"data-v-d65ade9e",null);t.default=n.exports},UKAY:function(s,t){}});