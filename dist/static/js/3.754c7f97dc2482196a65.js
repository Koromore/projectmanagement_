webpackJsonp([3],{"aK+C":function(t,e){},m4ws:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("xxyk"),i={name:"project_details",props:{clickCloseNum:Number},components:{taskDetail:a.a},data:function(){return{userId:this.$store.state.user.userId,deptId:this.$store.state.user.deptId,subordinate:this.$store.state.user.subordinate,manager:"",proInitUserId:"",loading:!1,drawerLoading:!1,proId:"",proName:"",taskId:0,type:"",loginState:!0,project_style:"",drawer1:!1,drawer2:!1,drawer3:!1,drawer4:!1,drawer3_task:"",drawer4_task:"",sousuo_show:!1,sousuo_input:"",taskList:[],deptList:[],departmentList:[],projectShowDetail:{delayReason:null},pasProjectapiDetai:{},tabs_activity:1,table_show:!0,faTaskList:[],faTaskDisabled:!1,new_task:{faTask:"",new_name:"",department:"",presetTime:"",task_type:"",remark:""},proExpertTime:"",pickerOptions:{},records_list:[{time:"20/04/02 20:46",result:"前端开发时间变动",people:"解雨臣",file_name:"文档",file_format:"ppt",file_url:""},{time:"20/04/02 20:46",result:"策划方案预计完成时间改动",people:"解雨臣",file_name:"文档",file_format:"ppt",file_url:""}],style1:"",feedbackContent:"",taskFeedbackId:"",projFeedbackId:"",feedbackFileList:[],task_type:[],task_type_value:"",taskData:{listOaUser:[]},batton_pa:!0,result:"",resultBan:!1,dialogImageUrl:"",dialogVisible:!1,disabled:!1,uploadUrl:"",listProFile:[],suggest_list:[],fileList0:[],disabled0:!0,disabled1:!0,updateBan:!1,dialogImageUrlResult:"",dialogVisibleResult:!1,disabledResult:!1,listProFileResult:[],fileList1:[],oldFileId:"",changeDoUserNameShow:"true",nextuserList:[],nextuserValue:"",changeNameShow:!1,userValue:"",knowUserShow:!0}},watch:{drawer5:function(t,e){0==this.drawer5&&(this.changeNameShow=!1)},clickCloseNum:function(t,e){this.changeDoUserNameShow="true",this.sousuo_show=!1}},methods:{pickerOptionsTime:function(){var t=this.proExpertTime;this.pickerOptions={disabledDate:function(e){return e.getTime()<Date.now()-864e5||e.getTime()>new Date(t).getTime()}}},formatData:function(t){var e=t.getFullYear(),s=t.getMonth()+1,a=t.getDate();return s>=1&&s<=9&&(s="0"+s),a>=0&&a<=9&&(a="0"+a),e+"-"+s+"-"+a},formatData2:function(t){var e=t.getFullYear(),s=t.getMonth()+1,a=t.getDate(),i=t.getHours(),r=t.getMinutes(),o=t.getSeconds();return s>=1&&s<=9&&(s="0"+s),a>=0&&a<=9&&(a="0"+a),i>=0&&i<=9&&(i="0"+i),r>=0&&r<=9&&(r="0"+r),o>=0&&o<=9&&(o="0"+o),e+"-"+s+"-"+a+" "+i+":"+r+":"+o},widthheight:function(){window.innerWidth;var t=window.innerHeight-100;this.style1="height:"+t+"px;"},blur:function(){this.$refs.input.blur()},addtask:function(){this.drawer1=!0,this.taskData={listOaUser:[]},this.getParentTask(),this.getDeptList(),setTimeout(this.blur,100)},table_tab:function(t){if(this.tabs_activity=t,1==t)this.getParams();else if(2==t){var e=this.proId;this.getProjectShowDetail(e)}},redact:function(t){var e=this;this.$confirm("是否忽略此任务","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then(function(){var s="taskId="+t;e.ignoreTask(s)}).catch(function(t){e.$message({type:"info",message:"放弃"})})},ignoreTask:function(t){var e=this;this.$axios.post("/pmbs/api/task/ignoreTask?"+t).then(function(t){200==t.status&&(e.messageWin(t.data.msg),e.getParams())})},feedback:function(t,e,s,a){this.drawer3=!0,this.drawer3_task=""+a,this.taskFeedbackId=e,this.projFeedbackId=t,console.log(this.feedbackFileList)},achieve:function(t,e){if(1==e){var s={taskId:t,status:2};this.taskSave(s)}else if(2==e){var a={taskId:t,status:3,overTime:this.formatData2(new Date)};this.taskSave(a)}else 4==e&&(this.drawer4=!0,this.drawer4_task=task)},gantt:function(t){var e=this.$route.query.id,s=this.$route.query.type;this.$router.push({path:"/gantti",query:{id:e,type:s}})},sousuoShow:function(t){this.sousuo_show=!this.sousuo_show},sousuo:function(){this.getParams(this.sousuo_input)},sousuo_:function(){},task_detail:function(t){this.taskId=t.taskId},getParams:function(t){this.userId;var e=this.$route.query.id,s=this.$route.query.type;this.proId=e,this.type=s,0==s?this.getProjectOfTask(e,t):1==s&&this.getProjectOfUserTask(e,t),this.getProjectShowDetail(e)},getProjectOfTask:function(t,e){this.loading=!0;var s="",a=this.userId;s=void 0!=e?"?proId="+t+"&taskName="+e+"&userId="+a:"?proId="+t+"&userId="+a,this.$axios.post("/pmbs/api/project/projectOfTask"+s).then(this.getProjectOfTaskSuss)},getProjectOfTaskSuss:function(t){if(this.loading=!1,200==t.status){var e=t.data.data;this.taskList=e}},getProjectOfUserTask:function(t,e){this.loading=!0;var s="",a=this.userId;s=void 0!=e?"?proId="+t+"&taskName="+e+"&userId="+a:"?proId="+t+"&userId="+a,this.$axios.post("/pmbs/api/project/projectOfUserTask"+s).then(this.getProjectOfUserTaskSuss)},getProjectOfUserTaskSuss:function(t){if(this.loading=!1,200==t.status){t.data.data;var e=t.data.data;this.taskList=e}},getProjectShowDetail:function(t){this.loading=!0;var e="?proId="+t;this.$axios.post("/pmbs/api/project/showDetail"+e).then(this.getProjectShowDetailSuss)},getProjectShowDetailSuss:function(t){if(this.loading=!1,200==t.status){var e=t.data.data;this.projectShowDetail=e,this.proName=e.proName,this.proExpertTime=e.expertTime,this.manager=e.manager,this.proInitUserId=e.initUserId,this.pickerOptionsTime();var s=e.knowUser.split(","),a=!0,i=this.userId;s.forEach(function(t){t==i&&(a=!1)}),this.knowUserShow=a;var r=this.projectShowDetail.pasprojectId;this.getProjectapiDetai(r)}},getProjectapiDetai:function(t){this.loading=!0;var e="?projectId="+t;this.$axios.post("http://pms.guoxinad.com.cn/pas/projectapi/projectDetailAjax"+e).then(this.getProjectapiDetaiSuss)},getProjectapiDetaiSuss:function(t){if(this.loading=!1,200==t.status){var e=t.data;this.pasProjectapiDetai=e}},getDeptList:function(t){if(0==this.deptList.length){this.$axios.post("/pmbs/department/deptList",{pageNum:1}).then(this.getDeptListSuss)}},getDeptListSuss:function(t){if(200==t.status){var e=t.data.data,s=(this.deptId,[]);e.forEach(function(t,e){var a={value:t.deptId,label:t.deptName,children:[]},i=t.listUser;null!=i&&i.forEach(function(t,e){var s={value:t.userId,label:t.realName};a.children.push(s)}),s.push(a)}),this.deptList=s,this.departmentList=e}},getParentTask:function(){var t="?userId="+this.userId+"&proId="+this.$route.query.id+"&depId="+this.$store.state.user.deptId;this.$axios.post("/pmbs/api/task/findParentTask"+t).then(this.getParentTaskSuss)},getParentTaskSuss:function(t){if(200==t.status){for(var e=t.data,s=[],a=0;a<e.length;a++){var i=e[a],r={};r.value=i.taskId,r.label=i.taskName,s.push(r)}this.faTaskList=s,0==s.length?this.faTaskDisabled=!0:this.faTaskDisabled=!1}},upload:function(){this.uploadUrl="\n      /pmbs/file/upload?upType=1&demandType=0\n      "},handleSuccess:function(t,e,s){if(0==t.errcode){var a=t.data,i=this.listProFile,r={proId:this.taskData.proId||"",taskId:this.taskData.taskId||"",fileId:"",fileName:a.fileName,isPro:1,deleteFlag:!1,ptId:this.taskData.taskId||"",localPath:a.path,suffix:a.fileType};i.push(r),this.listProFile=i,console.log(this.listProFile)}0==s.length?this.disabled1=!0:this.disabled1=!1},handleRemove:function(t,e){for(var s=t,a=this.listProFile,i=0;i<a.length;i++){a[i].fileId==s.fileId&&(a[i].deleteFlag=!0)}this.listProFile=a,0==e.length?this.disabled1=!0:this.disabled1=!1},addTaskClose:function(){this.$refs.addUpload.clearFiles(),this.listProFile=[]},putIn:function(){var t="";this.new_task.presetTime&&(t=this.$date0(this.new_task.presetTime));for(var e=this.formatData2(new Date),s=this.new_task.department,a=this.departmentList,i=0;i<a.length;i++){var r=a[i];s==r.deptId&&r.principalUserId}var o={createTime:e,deptId:s[0],doUserId:s[1],expertTime:t,faTask:this.new_task.faTask,initUserId:this.userId,proFileList:this.listProFile,proId:this.proId,remark:this.new_task.remark,taskName:this.new_task.new_name,typeId:this.task_type_value};""==o.department||""==o.taskName||""==o.expertTime||""==o.remark||""==o.deptId||""==o.doUserId?this.messageError("带*信息不能为空"):(this.taskSave(o),this.drawer1=!1,this.new_task.presetTime="",this.new_task.faTask="",this.new_task.department="",this.new_task.new_name="",this.new_task.presetTime="",this.task_type_value="",this.new_task.remark="",this.listProFile=[])},taskSave:function(t){this.$axios.post("/pmbs/api/task/save",t).then(this.taskSaveSuss)},taskSaveSuss:function(t){200==t.status&&(this.messageWin(t.data.msg),this.result="",this.listProFile=[],this.listProFileResult=[],this.getParams())},handleRemoveFeedback:function(t,e){for(var s=this.feedbackFileList,a=t.response.data,i=0;i<s.length;i++){s[i].localPath==a.path&&s.splice(i,1)}this.feedbackFileList=s,0==e.length?this.disabled0=!0:this.disabled0=!1},handleSuccessFeedback:function(t,e,s){var a=t.data,i=this.feedbackFileList,r=new Date,o={createTime:r,deleteFlag:!1,feedbackId:"",fileId:"",fileName:a.fileName,localPath:a.path,suffix:a.fileType,taskId:"",updateTime:r};i.push(o),0==s.length?this.disabled0=!0:this.disabled0=!1},exceed:function(){this.messageWarning("只能上传一个文件")},feedbackClose:function(){this.$refs.feedbackUpload.clearFiles(),this.feedbackFileList=[],this.feedbackContent=""},taskFeedback:function(){for(var t=new Date,e=this.taskFeedbackId,s=this.feedbackFileList,a=0;a<s.length;a++){s[a];s[a].taskId=e}var i={feedback:this.feedbackContent,feedbackFileList:s,initUserId:this.userId,proId:this.projFeedbackId,taskId:e,updateTime:t};""==i.feedback?this.messageError("带*信息不能为空"):this.$axios.post("/pmbs/api/project/taskfeedback",i).then(this.taskFeedbackSuss)},taskFeedbackSuss:function(t){200==t.status&&(this.messageWin("反馈成功"),this.drawer3=!1,this.feedbackContent="",this.taskFeedbackId="",this.getParams())},getDepTypeList:function(t){if(void 0!=t){this.new_task.department[0];var e={depType:{deptId:t[0]},pageSize:100,pageNum:1};this.$axios.post("/pmbs/api/depType/listAjax",e).then(this.getDepTypeListSuss)}},getDepTypeListSuss:function(t){if(200==t.status){for(var e=t.data.items,s=[],a={},i=0;i<e.length;i++){var r=e[i];a={value:r.typeId,label:r.typeName},s.push(a)}this.task_type=s}},changeDoUserName:function(t,e){this.changeDoUserNameShow=t,this.getNextuserList(e)},getNextuserList:function(t){for(var e=t,s=[],a=0;a<e.length;a++){var i=e[a],r={value:i.userId,label:i.realName};s.push(r)}this.nextuserList=s},changeDoUserNameAffirm:function(t){var e=this.nextuserValue;t.proFileList=[],""==e?this.changeDoUserNameShow="true":(t.doUserId=e,this.$axios.post("/pmbs/api/task/save",t).then(this.changeDoUserNameAffirmSuss))},changeDoUserNameAffirmSuss:function(t){200==t.status&&(this.messageWin("执行人修改成功"),this.getParams(),this.changeDoUserNameShow="true")},changeName:function(){this.changeNameShow=!0},empty:function(){this.drawer1=!1,this.drawer2=!1,this.drawer3=!1,this.drawer4=!1,this.feedbackContent="",this.result="",this.new_task.faTask="",this.new_task.department="",this.new_task.new_name="",this.new_task.presetTime="",this.task_type_value="",this.new_task.remark="",this.file_list=[],this.listProFileResult=[]},sponsor_achieve:function(t){var e=this;this.$confirm("是否确认此操作？","确认信息",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}).then(function(){var s=new Date(new Date(t.expertTime).getTime()+864e5),a=new Date,i={taskId:t.taskId,expertTime:t.expertTime,status:3};s<a&&(i.status=5),e.approveTask(i)}).catch(function(){e.$message({type:"info",message:"已取消"})})},approveTask:function(t){var e=this;this.$axios.post("/pmbs/api/task/approveTask",t).then(function(t){200==t.status&&(e.messageWin(t.data.msg),e.getParams())})},closeDrawer:function(t){this.taskId=0,1==t&&this.getParams()},download:function(t){var e=t.localPath,s=document.createElement("a");s.download=t.fileName+"."+t.suffix,console.log(s.download),s.setAttribute("href","http://218.106.254.122:8084/pmbs/"+e),s.click()},messageWin:function(t){this.$message({message:t,type:"success"})},messageWarning:function(t){this.$message({message:t,type:"warning"})},messageError:function(t){this.$message.error(t)}},mounted:function(){this.getParams(),this.upload()}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"project_details",style:t.project_style},[s("el-row",[s("el-col",{staticClass:"top",attrs:{span:24}},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/home/components/project?page=1"}}},[t._v("项目")]),t._v(" "),s("el-breadcrumb-item",{staticClass:"act"},[t._v(t._s(t.proName))])],1)],1),t._v(" "),s("el-col",{staticClass:"tabs",attrs:{span:6}},[s("el-button-group",[s("el-button",{class:["1"==t.tabs_activity?"act":""],attrs:{type:"primary",plain:"",size:"small"},on:{click:function(e){return t.table_tab(1)}}},[t._v("执行情况")]),t._v(" "),s("el-button",{class:["2"==t.tabs_activity?"act":""],attrs:{type:"primary",plain:"",size:"small"},on:{click:function(e){return t.table_tab(2)}}},[t._v("项目需求")])],1)],1),t._v(" "),s("el-col",{staticClass:"detail_list",attrs:{span:4,offset:13}},[s("el-col",{directives:[{name:"show",rawName:"v-show",value:!t.sousuo_show,expression:"!sousuo_show"}],attrs:{span:24}},[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增任务",placement:"bottom"}},[3!=t.projectShowDetail.status&&1==t.knowUserShow?s("i",{staticClass:"el-icon-circle-plus-outline",on:{click:t.addtask}}):t._e()]),t._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"甘特图",placement:"bottom"}},[s("i",{staticClass:"el-icon-tickets",on:{click:function(e){return t.gantt(1)}}})]),t._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"任务查询",placement:"bottom"}},[s("i",{staticClass:"el-icon-search",on:{click:function(e){return e.stopPropagation(),t.sousuoShow(e)}}})])],1),t._v(" "),s("el-col",{directives:[{name:"show",rawName:"v-show",value:t.sousuo_show,expression:"sousuo_show"}],staticClass:"sousuo",attrs:{span:24}},[s("el-col",{attrs:{span:20}},[s("div",{staticStyle:{},on:{click:function(e){return e.stopPropagation(),t.sousuo_(e)}}},[s("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:t.sousuo_input,callback:function(e){t.sousuo_input=e},expression:"sousuo_input"}},[s("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},on:{click:function(e){return e.stopPropagation(),t.sousuo(e)}},slot:"suffix"})])],1)]),t._v(" "),s("el-col",{attrs:{span:3,offset:1}},[s("i",{staticClass:"el-icon-circle-close",on:{click:function(e){return e.stopPropagation(),t.sousuoShow(e)}}})])],1)],1),t._v(" "),1==t.tabs_activity?s("el-col",{staticClass:"table table1",attrs:{span:24}},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"filterTable",staticStyle:{width:"100%"},attrs:{data:t.taskList,"header-cell-style":{background:"rgb(236, 235, 235)",color:"#000"}}},[s("el-table-column",{attrs:{prop:"taskName",label:"任务名称","show-overflow-tooltip":"","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-link",{attrs:{type:"primary"},on:{click:function(s){return t.task_detail(e.row)}}},[t._v(t._s(e.row.taskName))])]}}],null,!1,203963858)}),t._v(" "),s("el-table-column",{attrs:{prop:"deptName",label:"部门","show-overflow-tooltip":"","min-width":"120"}}),t._v(" "),s("el-table-column",{attrs:{prop:"doUserName",label:"执行人",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{directives:[{name:"show",rawName:"v-show",value:t.changeDoUserNameShow!=e.$index,expression:"changeDoUserNameShow != scope.$index"}],staticClass:"doUserName"},[s("span",[t._v(t._s(e.row.doUserName))]),t._v(" "),1!=e.row.isIgnore&&e.row.listOaUser.length>1&&2!=e.row.status&&3!=e.row.status&&5!=e.row.status&&e.row.deptId==t.subordinate?s("img",{attrs:{src:"static/images/task/change.png",width:"18",alt:"",srcset:""},on:{click:function(s){return s.stopPropagation(),t.changeDoUserName(e.$index,e.row.listOaUser)}}}):t._e()]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.changeDoUserNameShow==e.$index,expression:"changeDoUserNameShow == scope.$index"}]},[s("el-select",{staticStyle:{width:"99px"},attrs:{filterable:"",placeholder:"请选择",size:"mini",clearable:""},model:{value:t.nextuserValue,callback:function(e){t.nextuserValue=e},expression:"nextuserValue"}},t._l(t.nextuserList,function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v(" "),s("el-button",{attrs:{slot:"append",type:"primary",size:"mini"},on:{click:function(s){return s.stopPropagation(),t.changeDoUserNameAffirm(e.row)}},slot:"append"},[t._v("确认")])],1)]}}],null,!1,3437992647)}),t._v(" "),s("el-table-column",{attrs:{prop:"status",label:"状态","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.isIgnore?s("span",{staticClass:"state_color3"},[t._v("忽略")]):1==e.row.status?s("span",{staticClass:"state_color1"},[t._v("执行中")]):2==e.row.status?s("span",{staticClass:"state_color2"},[t._v("审核中")]):3==e.row.status?s("span",{staticClass:"state_color3"},[t._v("完成")]):4==e.row.status?s("span",{staticClass:"state_color4"},[t._v("延期")]):5==e.row.status?s("span",{staticClass:"state_color3"},[t._v("延期完成")]):t._e()]}}],null,!1,2025884700)}),t._v(" "),s("el-table-column",{attrs:{prop:"expertTime",label:"预计时间",sortable:"","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.$date(e.row.expertTime)))]}}],null,!1,3359096663)}),t._v(" "),s("el-table-column",{attrs:{prop:"overTime",label:"完成时间",sortable:"","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.$date(e.row.overTime)))]}}],null,!1,381762103)}),t._v(" "),s("el-table-column",{attrs:{prop:"initUserName",label:"下达人","min-width":"72"}}),t._v(" "),s("el-table-column",{attrs:{label:"成果","show-overflow-tooltip":"","min-width":"95"},scopedSlots:t._u([{key:"default",fn:function(e){return 0!=e.row.taskfileList.length?s("div",{staticClass:"taskfile",on:{click:function(s){return t.download(e.row.taskfileList[0])}}},["doc"==e.row.taskfileList[0].suffix||"docx"==e.row.taskfileList[0].suffix?s("img",{attrs:{src:"static/images/document/word.png",width:"16",alt:"",srcset:""}}):"xls"==e.row.taskfileList[0].suffix||"xlsx"==e.row.taskfileList[0].suffix?s("img",{attrs:{src:"static/images/document/excle.png",width:"16",alt:"",srcset:""}}):"ppt"==e.row.taskfileList[0].suffix||"pptx"==e.row.taskfileList[0].suffix?s("img",{attrs:{src:"static/images/document/ppt.png",width:"16",alt:"",srcset:""}}):s("img",{attrs:{src:"static/images/document/other.png",width:"16",alt:"",srcset:""}}),t._v(" "),s("el-link",{staticClass:"filenametext",attrs:{type:"primary"}},[t._v(t._s(e.row.taskfileList[0].fileName))])],1):t._e()}}],null,!0)}),t._v(" "),152!=t.userId?s("el-table-column",{attrs:{prop:"操作",label:"操作","filter-placement":"bottom-end","min-width":"160"},scopedSlots:t._u([{key:"default",fn:function(e){return 1!=e.row.isIgnore?[t.userId==e.row.initUserId?s("div",{staticClass:"linblo"},[1!=e.row.isIgnore&&3!=e.row.status&&5!=e.row.status?s("el-button",{attrs:{size:"small",type:"info"},on:{click:function(s){return t.feedback(e.row.proId,e.row.taskId,e.row.proName,e.row.taskName)}}},[t._v("反馈")]):t._e()],1):t.userId==t.proInitUserId||t.userId==t.manager?s("div",{staticClass:"linblo"},[1!=e.row.isIgnore&&1==e.row.status?s("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(s){return t.feedback(e.row.proId,e.row.taskId,e.row.proName,e.row.taskName)}}},[t._v("反馈")]):t._e()],1):t._e(),t._v(" "),t.userId==e.row.initUserId?s("div",{staticClass:"linblo"},[1!=e.row.isIgnore&&2==e.row.status?s("el-button",{attrs:{slot:"reference",size:"mini",type:"primary"},on:{click:function(s){return t.sponsor_achieve(e.row)}},slot:"reference"},[t._v("完成")]):t._e()],1):t.userId==e.row.doUserId?s("div",{staticClass:"linblo"},[1!=e.row.isIgnore&&1==e.row.status||4==e.row.status?s("el-button",{attrs:{slot:"reference",size:"mini",type:"info"},on:{click:function(s){return t.redact(e.row.taskId)}},slot:"reference"},[t._v("忽略")]):t._e(),t._v(" "),1!=e.row.isIgnore&&1==e.row.status||4==e.row.status?s("el-button",{attrs:{slot:"reference",size:"mini",type:"primary"},on:{click:function(s){return t.task_detail(e.row)}},slot:"reference"},[t._v("完成")]):t._e()],1):t._e()]:void 0}}],null,!0)}):t._e()],1)],1):t._e(),t._v(" "),2==t.tabs_activity?s("el-col",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"table table2",attrs:{span:24}},[s("el-col",{staticClass:"need",attrs:{span:14}},[s("el-col",{staticClass:"span",attrs:{span:24}},[t._v("信息")]),t._v(" "),s("el-col",{staticClass:"content",attrs:{span:24}},[s("span",[t._v("项目名称")]),t._v(" "),s("span",{staticClass:"colorBlack"},[t._v("\n            :  \n            "+t._s(t.projectShowDetail.proName)+"\n          ")]),t._v(" "),s("br"),t._v(" "),s("span",[t._v("项目类别")]),t._v(" "),s("span",{staticClass:"colorBlack"},[t._v("\n            :  \n            "+t._s(t.pasProjectapiDetai.clientName)+"-\n            "+t._s(t.projectShowDetail.businessName)+"-\n            "+t._s(t.projectShowDetail.projectType)+"\n          ")]),t._v(" "),s("br"),t._v(" "),s("span",[t._v("预计时间")]),t._v(" "),s("span",{staticClass:"colorBlack"},[t._v("\n            :  \n            "+t._s(t.$date(t.projectShowDetail.createTime))+"至"+t._s(t.$date(t.projectShowDetail.expertTime))+"\n          ")])]),t._v(" "),s("el-col",{staticClass:"span",attrs:{span:24}},[t._v("需求")]),t._v(" "),s("el-col",{staticClass:"content",attrs:{span:24}},[s("pre",[t._v(t._s(t.projectShowDetail.remark))])]),t._v(" "),s("el-col",{staticClass:"span",attrs:{span:24}},[t._v("附件")]),t._v(" "),s("el-col",{staticClass:"fileList",attrs:{span:24}},t._l(t.projectShowDetail.listProFile,function(e){return s("el-tooltip",{key:e.index,staticClass:"item",attrs:{effect:"dark",content:e.fileName,placement:"top",tabindex:""}},[s("div",{staticClass:"fileList_",on:{click:function(s){return t.download(e)}}},["doc"==e.suffix||"docx"==e.suffix?s("img",{attrs:{src:"static/images/document/word.png",alt:"",srcset:""}}):"xls"==e.suffix||"xlsx"==e.suffix?s("img",{attrs:{src:"static/images/document/excle.png",alt:"",srcset:""}}):"ppt"==e.suffix||"pptx"==e.suffix?s("img",{attrs:{src:"static/images/document/ppt.png",alt:"",srcset:""}}):s("img",{attrs:{src:"static/images/document/other.png",alt:"",srcset:""}}),t._v(" "),s("br"),t._v(" "),s("span",[t._v(t._s(e.fileName))])])])}),1),t._v(" "),null!=t.projectShowDetail.delayReason?s("el-col",{staticClass:"span",attrs:{span:24}},[t._v("延期原因")]):t._e(),t._v(" "),null!=t.projectShowDetail.delayReason?s("el-col",{attrs:{span:24}},[t._v(t._s(t.projectShowDetail.delayReason))]):t._e()],1),t._v(" "),s("el-col",{staticClass:"approval need",attrs:{span:10}},[s("el-col",{staticClass:"span",attrs:{span:24}},[t._v("立项背景")]),t._v(" "),s("el-col",{staticClass:"content",attrs:{span:24}},[s("div",{staticClass:"title"},[t._v("立项名称")]),t._v(" "),s("span",[t._v(":  "+t._s(t.pasProjectapiDetai.projectName))]),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"title"},[t._v("项目类别")]),t._v(" "),1==t.pasProjectapiDetai.proCategory?s("span",[t._v(":  正常")]):2==t.pasProjectapiDetai.proCategory?s("span",[t._v(":  特殊")]):3==t.pasProjectapiDetai.proCategory?s("span",[t._v(":  自有")]):4==t.pasProjectapiDetai.proCategory?s("span",[t._v(":  行政")]):t._e(),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"title"},[t._v("合同归属地")]),t._v(" "),s("span",[t._v(":  "+t._s(t.pasProjectapiDetai.companyName))]),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"title"},[t._v("客户名称")]),t._v(" "),s("span",[t._v(":  "+t._s(t.pasProjectapiDetai.clientName))]),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"title"},[t._v("品牌")]),t._v(" "),s("span",[t._v(":  "+t._s(t.pasProjectapiDetai.brandName))]),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"title"},[t._v("立项日期")]),t._v(" "),s("span",[t._v(":  "+t._s(t.pasProjectapiDetai.establishTime))]),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"title"},[t._v("项目编号")]),t._v(" "),s("span",[t._v(":  "+t._s(t.pasProjectapiDetai.projectNumber))]),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"title"},[t._v("项目类型")]),t._v(" "),1==t.pasProjectapiDetai.protype?s("span",[t._v(":  日常")]):2==t.pasProjectapiDetai.protype?s("span",[t._v(":  专项")]):t._e(),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"title"},[t._v("项目执行周期")]),t._v(" "),s("span",[t._v(":  "+t._s(t.pasProjectapiDetai.startTime)+"--- "+t._s(t.pasProjectapiDetai.endTime))]),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"title"},[t._v("客户部服务人员")]),t._v(" "),s("span",[t._v(":  "+t._s(t.pasProjectapiDetai.customerServiceName))])])],1)],1):t._e(),t._v(" "),s("el-drawer",{attrs:{title:"创建任务",visible:t.drawer1,"with-header":!1},on:{"update:visible":function(e){t.drawer1=e},close:t.addTaskClose}},[s("el-scrollbar",{staticStyle:{height:"100%"}},[s("el-row",{staticClass:"add_box"},[s("el-col",{attrs:{span:24}},[s("el-col",{staticClass:"title title1",attrs:{span:6}},[t._v("创建任务")])],1),t._v(" "),s("el-col",{staticClass:"title",attrs:{span:6}},[t._v("父任务")]),t._v(" "),s("el-col",{attrs:{span:18}},[s("el-select",{ref:"input",staticClass:"parent_task",attrs:{filterable:"",placeholder:"请选择",clearable:"",disabled:t.faTaskDisabled},model:{value:t.new_task.faTask,callback:function(e){t.$set(t.new_task,"faTask",e)},expression:"new_task.faTask"}},t._l(t.faTaskList,function(t){return s("el-option",{key:t.index,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),s("el-col",{attrs:{span:24}},[s("el-col",{staticClass:"title title2",attrs:{span:6}},[t._v("执行人")]),t._v(" "),s("el-col",{staticClass:"department",attrs:{span:18}},[s("el-cascader",{attrs:{options:t.deptList,clearable:"",filterable:""},on:{change:t.getDepTypeList},model:{value:t.new_task.department,callback:function(e){t.$set(t.new_task,"department",e)},expression:"new_task.department"}})],1)],1),t._v(" "),s("el-col",{staticClass:"title",attrs:{span:6}},[t._v("任务名称")]),t._v(" "),s("el-col",{attrs:{span:18}},[s("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:t.new_task.new_name,callback:function(e){t.$set(t.new_task,"new_name",e)},expression:"new_task.new_name"}})],1),t._v(" "),s("el-col",{staticClass:"title",attrs:{span:6}},[t._v("任务类型")]),t._v(" "),s("el-col",{staticClass:"task_type",attrs:{span:18}},[s("el-select",{attrs:{placeholder:"请选择任务类型","no-data-text":"请先选择部门"},model:{value:t.task_type_value,callback:function(e){t.task_type_value=e},expression:"task_type_value"}},t._l(t.task_type,function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),s("el-col",{staticClass:"title",attrs:{span:6}},[t._v("预计时间")]),t._v(" "),s("el-col",{staticClass:"presetTime",attrs:{span:18}},[s("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","picker-options":t.pickerOptions},model:{value:t.new_task.presetTime,callback:function(e){t.$set(t.new_task,"presetTime",e)},expression:"new_task.presetTime"}})],1),t._v(" "),s("el-col",{staticClass:"title",attrs:{span:6}},[t._v("需求")]),t._v(" "),s("el-col",{attrs:{span:18}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:6,maxRows:8},placeholder:"请输入内容",maxlength:"300","show-word-limit":""},model:{value:t.new_task.remark,callback:function(e){t.$set(t.new_task,"remark",e)},expression:"new_task.remark"}})],1),t._v(" "),s("el-col",{staticClass:"title nobgimg",attrs:{span:6}},[t._v("附件")]),t._v(" "),s("el-col",{staticClass:"upload",attrs:{span:18}},[s("el-upload",{ref:"addUpload",attrs:{action:t.uploadUrl,"on-remove":t.handleRemove,"on-success":t.handleSuccess,limit:1,"on-exceed":t.exceed}},[s("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传附件")]),t._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传一个文件")])],1)],1)],1)],1),t._v(" "),s("el-col",{staticClass:"batton",attrs:{span:24}},[s("el-button",{attrs:{size:"small",type:"info"},on:{click:t.empty}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.putIn}},[t._v("提交")])],1)],1),t._v(" "),s("el-drawer",{attrs:{title:"历史记录",visible:t.drawer2,"with-header":!1},on:{"update:visible":function(e){t.drawer2=e}}},[s("el-row",{staticClass:"records"},[s("el-col",{staticClass:"title",attrs:{span:23,offset:1}},[t._v("历史记录")]),t._v(" "),s("el-col",{staticClass:"records_list",style:t.style1,attrs:{span:23,offset:1}},[s("el-scrollbar",[s("el-timeline",t._l(t.records_list,function(e){return s("el-timeline-item",{key:e.index,attrs:{timestamp:e.time,placement:"top"}},[s("el-card",{staticClass:"content"},[s("p",[t._v("变动内容："+t._s(e.result))]),t._v(" "),s("p",[t._v("更新人："+t._s(e.people))])])],1)}),1)],1)],1)],1)],1),t._v(" "),s("el-drawer",{attrs:{title:"任务",visible:t.drawer3,"with-header":!1},on:{"update:visible":function(e){t.drawer3=e},close:t.feedbackClose}},[s("el-row",{staticClass:"feedback"},[s("el-col",{attrs:{span:24}},[s("el-col",{staticClass:"title",attrs:{span:24}},[t._v(t._s(t.drawer3_task))]),t._v(" "),s("el-col",{staticClass:"title snow",attrs:{span:6}},[t._v("反馈")]),t._v(" "),s("el-col",{attrs:{span:24}},[s("el-input",{attrs:{type:"textarea",rows:9,placeholder:"请输入内容",maxlength:"300","show-word-limit":""},model:{value:t.feedbackContent,callback:function(e){t.feedbackContent=e},expression:"feedbackContent"}})],1),t._v(" "),s("el-col",{staticClass:"title upload",attrs:{span:6}},[t._v("附件")]),t._v(" "),s("el-col",{staticClass:"feedbackUpload",attrs:{span:24}},[s("el-upload",{ref:"feedbackUpload",staticClass:"elementUpload",attrs:{action:"/pmbs/file/upload?upType=1&demandType=1","on-remove":t.handleRemoveFeedback,"on-success":t.handleSuccessFeedback,limit:1,"on-exceed":t.exceed}},[s("el-button",{attrs:{size:"mini",type:"primary"}},[t._v("点击上传文档")]),t._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传一个文件")])],1)],1)],1)],1),t._v(" "),s("el-col",{staticClass:"batton",attrs:{span:24}},[s("el-button",{attrs:{size:"small",type:"info"},on:{click:t.empty}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.taskFeedback}},[t._v("提交")])],1)],1),t._v(" "),s("el-drawer",{attrs:{title:"任务",visible:t.drawer4,"with-header":!1},on:{"update:visible":function(e){t.drawer4=e}}},[s("el-row",{staticClass:"feedback"},[s("el-col",{attrs:{span:24}},[s("el-col",{staticClass:"title",attrs:{span:24}},[t._v(t._s(t.drawer4_task))]),t._v(" "),s("el-col",{staticClass:"title snow",attrs:{span:6}},[t._v("延期原因")]),t._v(" "),s("el-col",{attrs:{span:24}},[s("el-input",{attrs:{type:"textarea",rows:9,placeholder:"请输入内容",maxlength:"300","show-word-limit":""},model:{value:t.result,callback:function(e){t.result=e},expression:"result"}})],1)],1),t._v(" "),s("el-col",{staticClass:"batton",attrs:{span:24}},[s("el-button",{attrs:{size:"small",type:"info"},on:{click:t.empty}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{size:"small",type:"primary"}},[t._v("提交")])],1)],1)],1),t._v(" "),s("taskDetail",{attrs:{taskId:t.taskId},on:{closeDrawer:t.closeDrawer}})],1)],1)},staticRenderFns:[]};var o=s("VU/8")(i,r,!1,function(t){s("aK+C")},"data-v-a1f23880",null);e.default=o.exports}});