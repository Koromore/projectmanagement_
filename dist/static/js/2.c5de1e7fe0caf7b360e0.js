webpackJsonp([2],{vUBr:function(t,e){},ydW9:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={name:"task",data:function(){return{drawer1:!1,drawer2:!1,drawer3:!1,drawer2_task:"",drawer3_task:"",change_carryPeople_show:"true",loginState:!0,project_style:"",client_list:[{value:"广汽本田",label:"广汽本田"},{value:"吉利",label:"吉利"},{value:"沃尔沃",label:"沃尔沃"}],client:"广汽本田",tasklist:[],initiateTaskListTota:0,tasklist_:[],participateTaskListTota:0,taskDetail:{},tableData2:[],result:"",tabs_activity:1,table_show:!0,tab1_act:1,tab2_act:1,suggest_list:[{time:"2020-01-12 12:00",pop:"客户部-黄振宇",content:"请将色调调整为红色。"},{time:"2020-01-10 10:00",pop:"内容部-张三",content:"调整意见文本内容。"},{time:"2020-01-12 12:00",pop:"客户部-黄振宇",content:"请将色调调整为红色。"},{time:"2020-01-10 10:00",pop:"内容部-张三",content:"调整意见文本内容。"}],taskFeedbackId:"",feedbackContent:""}},methods:{widthheight:function(){window.innerWidth,window.innerHeight},table_tab:function(t){1==t?(this.tabs_activity=1,this.table_show=!0):2==t&&(this.tabs_activity=2,this.table_show=!1)},tab1_change:function(t){1==t?this.tab1_act=1:2==t?this.tab1_act=2:3==t&&(this.tab1_act=3)},tab2_change:function(t){1==t?this.tab2_act=1:2==t&&(this.tab2_act=2)},feedback:function(t,e,a){console.log("反馈"+t),this.drawer2=!0,this.drawer2_task=e+"-"+a,this.taskFeedbackId=t},sponsor_achieve:function(t,e,a){console.log("我发起完成"+t),4==a&&(this.drawer3=!0,this.drawer3_task=e)},join_redact:function(t){console.log("我参与忽略"+t)},join_achieve:function(t,e,a){console.log("我参与完成"+t),4==a&&(this.drawer3=!0,this.drawer3_task=e)},filterName:function(t,e){return e.name===t},filterDepartment:function(t,e){return e.department===t},task_detail:function(t){this.drawer1=!0,this.getTaskShow(t)},change_carryPeople:function(t){this.change_carryPeople_show=t},getTasklistAjax:function(t){var e={type:0,task:{initUserId:128},pageNum:t};this.$axios.post("/pmbs/api/task/listAjax",e).then(this.getTasklistAjaxSuss)},getTasklistAjaxSuss:function(t){if(200==t.status){var e=t.data.items;this.tasklist=e,this.initiateTaskListTota=t.data.totalRows}},getTasklistAjax_:function(t){var e={type:1,task:{initUserId:128},pageNum:t};this.$axios.post("/pmbs/api/task/listAjax",e).then(this.getTasklistAjax_Suss)},getTasklistAjax_Suss:function(t){if(200==t.status){var e=t.data.items;this.tasklist_=e,this.participateTaskListTota=t.data.totalRows}},getTaskShow:function(t){var e="?id="+t;this.$axios.post("/pmbs/api/task/show"+e).then(this.getTaskShowSuss)},getTaskShowSuss:function(t){if(200==t.status){var e=t.data;this.taskDetail=e}},taskDelete:function(t){var e="?id="+t;this.$axios.post("/pmbs/api/task/delete"+e).then(this.taskDeleteSuss)},taskDeleteSuss:function(t){if(200==t.status)t.data},taskFeedback:function(){var t=new Date,e={feedback:this.feedbackContent,initUserId:128,taskId:this.taskFeedbackId,updateTime:t};this.$axios.post("/pmbs/api/project/taskfeedback",e).then(this.taskFeedbackSuss)},taskFeedbackSuss:function(t){200==t.status&&(this.messageWin("反馈成功"),this.drawer2=!1,this.feedbackContent="",this.taskFeedbackId="",this.getTasklistAjax(1),this.getTasklistAjax_(1))},cancel:function(){this.drawer1=!1},initiateTaskList:function(t){this.getTasklistAjax(t)},participateTaskList:function(t){this.getTasklistAjax_(t)},messageWin:function(t){this.$message({message:t,type:"success"})},messageWarning:function(t){this.$message({message:t,type:"warning"})},messageError:function(t){this.$message.error(t)}},mounted:function(){this.widthheight(),this.getTasklistAjax(1),this.getTasklistAjax_(1)}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task",style:t.project_style},[a("el-row",[a("el-col",{staticClass:"top",attrs:{span:24}},[a("el-col",{attrs:{span:5}},[a("el-col",{staticClass:"title",attrs:{span:4}},[t._v("客户")]),t._v(" "),a("el-col",{attrs:{span:20}},[a("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.client,callback:function(e){t.client=e},expression:"client"}},t._l(t.client_list,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)],1),t._v(" "),a("el-col",{staticClass:"tab tab1",attrs:{span:6}},[a("el-button-group",[a("el-button",{class:["1"==t.tab1_act?"act":""],attrs:{type:"primary",plain:"",size:"small"},on:{click:function(e){return t.tab1_change(1)}}},[t._v("    官网    ")]),t._v(" "),a("el-button",{class:["2"==t.tab1_act?"act":""],attrs:{type:"primary",plain:"",size:"small"},on:{click:function(e){return t.tab1_change(2)}}},[t._v("    口碑    ")]),t._v(" "),a("el-button",{class:["3"==t.tab1_act?"act":""],staticStyle:{"border-left":"0"},attrs:{type:"primary",plain:"",size:"small"},on:{click:function(e){return t.tab1_change(3)}}},[t._v("数字营销")])],1)],1),t._v(" "),a("el-col",{staticClass:"tab tab2",attrs:{span:4}},[a("el-button-group",[a("el-button",{class:["1"==t.tab2_act?"act":""],attrs:{type:"primary",plain:"",size:"small"},on:{click:function(e){return t.tab2_change(1)}}},[t._v("    专项    ")]),t._v(" "),a("el-button",{class:["2"==t.tab2_act?"act":""],attrs:{type:"primary",plain:"",size:"small"},on:{click:function(e){return t.tab2_change(2)}}},[t._v("    日常    ")])],1)],1),t._v(" "),a("el-col",{staticClass:"tab tab3",attrs:{span:8}},[a("el-button-group",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新任务",placement:"bottom"}},[a("el-button",{attrs:{type:"primary",size:"small"}},[t._v("  1  ")])],1),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"延时",placement:"bottom"}},[a("el-button",{attrs:{type:"danger",size:"small"}},[t._v("    2    ")])],1),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"审核中",placement:"bottom"}},[a("el-button",{attrs:{type:"warning",size:"small"}},[t._v("  3  ")])],1),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"执行中",placement:"bottom"}},[a("el-button",{attrs:{type:"success",size:"small"}},[t._v("  4  ")])],1)],1)],1)],1),t._v(" "),a("el-col",{staticClass:"tabs",attrs:{span:24}},[a("div",{class:["1"==t.tabs_activity?"act":""],on:{click:function(e){return t.table_tab(1)}}},[t._v("我发起")]),t._v(" "),a("div",{class:["2"==t.tabs_activity?"act":""],on:{click:function(e){return t.table_tab(2)}}},[t._v("我参与")])]),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:t.table_show,expression:"table_show"}],staticClass:"table table1",attrs:{span:24}},[a("el-table",{ref:"filterTable",staticStyle:{width:"100%"},attrs:{data:t.tasklist,"header-cell-style":{background:"rgb(236, 235, 235)",color:"#000"},"row-style":{height:"57px",text_aling:"left"}}},[a("el-table-column",{attrs:{prop:"proName",label:"所属项目","column-key":"name",filters:[{text:"皓影赠礼",value:"皓影赠礼"},{text:"广本网站优化",value:"广本网站优化"}],"filter-method":t.filterName}}),t._v(" "),a("el-table-column",{attrs:{prop:"deptName",label:"部门",filters:[{text:"网络营销",value:"网络营销"},{text:"设计",value:"设计"},{text:"研发",value:"研发"},{text:"策划",value:"策划"},{text:"内容",value:"内容"}],"filter-method":t.filterDepartment}}),t._v(" "),a("el-table-column",{attrs:{prop:"taskName",label:"任务"},scopedSlots:t._u([{key:"default",fn:function(e){return a("el-link",{on:{click:function(a){return t.task_detail(e.row.taskId)}}},[t._v(t._s(e.row.taskName))])}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"执行状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("span",{staticClass:"state_color1"},[t._v("进行中")]):t._e(),t._v(" "),2==e.row.status?a("span",{staticClass:"state_color2"},[t._v("审核中")]):t._e(),t._v(" "),3==e.row.status?a("span",{staticClass:"state_color3"},[t._v("完成")]):t._e(),t._v(" "),4==e.row.status?a("span",{staticClass:"state_color4"},[t._v("延期")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"faTaskName",label:"父任务"}}),t._v(" "),a("el-table-column",{attrs:{prop:"expertTime",label:"预计时间"}},[a("template",{slot:"header"},[t._v("\n            预计时间\n            "),a("i",{staticClass:"el-icon-sort"})])],2),t._v(" "),a("el-table-column",{attrs:{prop:"tag",label:"操作",width:"180","filter-placement":"bottom-end"},scopedSlots:t._u([{key:"default",fn:function(e){return[3!=e.row.status||5!=e.row.status?a("el-button",{attrs:{size:"small",type:"info"},on:{click:function(a){return t.feedback(e.row.taskId,e.row.proName,e.row.taskName)}}},[t._v("反馈")]):t._e(),t._v(" "),a("el-popconfirm",{attrs:{title:"确认执行此操作吗？"},on:{onConfirm:function(a){return t.sponsor_achieve(e.row.id,e.row.task,e.row.state)}}},[2==e.row.status?a("el-button",{attrs:{slot:"reference",size:"small",type:"primary"},slot:"reference"},[t._v("完成")]):t._e()],1)]}}])})],1),t._v(" "),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.initiateTaskListTota},on:{"current-change":t.initiateTaskList}})],1),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:!t.table_show,expression:"!table_show"}],staticClass:"table table2",attrs:{span:24}},[a("el-table",{ref:"filterTable",staticStyle:{width:"100%"},attrs:{data:t.tasklist_,"header-cell-style":{background:"rgb(236, 235, 235)",color:"#000"},"row-style":{height:"57px"},align:"left"}},[a("el-table-column",{attrs:{prop:"deptName",label:"部门"}}),t._v(" "),a("el-table-column",{attrs:{prop:"taskName",label:"任务"},scopedSlots:t._u([{key:"default",fn:function(e){return a("el-link",{on:{click:function(a){return t.task_detail(e.row.taskId)}}},[t._v(t._s(e.row.taskName))])}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("span",{staticClass:"state_color1"},[t._v("进行中")]):t._e(),t._v(" "),2==e.row.status?a("span",{staticClass:"state_color2"},[t._v("审核中")]):t._e(),t._v(" "),3==e.row.status?a("span",{staticClass:"state_color3"},[t._v("完成")]):t._e(),t._v(" "),4==e.row.status?a("span",{staticClass:"state_color4"},[t._v("延期")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"doUserName",label:"执行人",width:"164"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{directives:[{name:"show",rawName:"v-show",value:t.change_carryPeople_show!=e.$index,expression:"change_carryPeople_show != scope.$index"}]},[t._v("\n              "+t._s(e.row.doUserName)+"\n              "),a("el-link",{directives:[{name:"show",rawName:"v-show",value:2==e.row.state||4==e.row.state,expression:"scope.row.state == 2 || scope.row.state == 4"}],attrs:{type:"primary"},on:{click:function(a){return t.change_carryPeople(e.$index)}}},[t._v("更换")])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.change_carryPeople_show==e.$index,expression:"change_carryPeople_show == scope.$index"}]},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容",size:"small "},model:{value:t.tasklist_[e.$index].doUserName,callback:function(a){t.$set(t.tasklist_[e.$index],"doUserName",a)},expression:"tasklist_[scope.$index].doUserName"}},[a("el-button",{attrs:{slot:"append",type:"primary"},on:{click:function(e){return t.change_carryPeople("true")}},slot:"append"},[t._v("确认")])],1)],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"expertTime",label:"预计时间"}},[a("template",{slot:"header"},[t._v("\n            预计时间\n            "),a("i",{staticClass:"el-icon-sort"})])],2),t._v(" "),a("el-table-column",{attrs:{prop:"overTime",label:"完成时间"}},[a("template",{slot:"header"},[t._v("\n            完成时间\n            "),a("i",{staticClass:"el-icon-sort"})])],2),t._v(" "),a("el-table-column",{attrs:{prop:"doUserName",label:"下达人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"result",label:"成果"},scopedSlots:t._u([{key:"default",fn:function(e){return 3==e.row.state?a("div",{staticClass:"result"},[a("img",{attrs:{src:"static/images/document/ppt.png",width:"24",alt:"",srcset:""}}),t._v(" "),a("div",[t._v("策划方案")])]):t._e()}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{prop:"operation",label:"操作",width:"180","filter-placement":"bottom-end"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popconfirm",{attrs:{title:"确认执行此操作吗？"},on:{onConfirm:function(a){return t.join_redact(e.row.id)}}},[4==e.row.status?a("el-button",{attrs:{slot:"reference",size:"small",type:"info"},slot:"reference"},[t._v("忽略")]):t._e()],1),t._v(" "),2==e.row.status?a("el-button",{attrs:{slot:"reference",size:"small",type:"info"},on:{click:function(a){return t.feedback(e.row.taskId,e.row.proName,e.row.taskName)}},slot:"reference"},[t._v("反馈")]):t._e(),t._v(" "),a("el-popconfirm",{attrs:{title:"确认执行此操作吗？"},on:{onConfirm:function(a){return t.join_achieve(e.row.id,e.row.task,e.row.state)}}},[1==e.row.status||4==e.row.status?a("el-button",{attrs:{slot:"reference",size:"small",type:"primary"},slot:"reference"},[t._v("完成")]):t._e()],1)]}}])})],1),t._v(" "),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.participateTaskListTota},on:{"current-change":t.participateTaskList}})],1),t._v(" "),a("el-drawer",{attrs:{title:"任务",visible:t.drawer1,"with-header":!1},on:{"update:visible":function(e){t.drawer1=e}}},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("el-row",{staticClass:"task_details"},[a("el-col",{staticClass:"title",attrs:{span:6}},[t._v("执行部门：")]),t._v(" "),a("el-col",{attrs:{span:18}},[t._v(t._s(t.taskDetail.deptName))]),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:6}},[t._v("任务类型：")]),t._v(" "),a("el-col",{attrs:{span:18}},[t._v("网站设计")]),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:6}},[t._v("执行人：")]),t._v(" "),a("el-col",{attrs:{span:18}},[t._v("张三")]),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:6}},[t._v("状态：")]),t._v(" "),a("el-col",{staticClass:"state_color2",attrs:{span:18}},[t._v("执行中")]),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:6}},[t._v("预计时间：")]),t._v(" "),a("el-col",{attrs:{span:18}},[t._v("20-01-21")]),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:6}},[t._v("完成时间：")]),t._v(" "),a("el-col",{attrs:{span:18}},[t._v("20-01-21")]),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:6}},[t._v("需求：")]),t._v(" "),a("el-col",{attrs:{span:18}},[t._v("PC网站设计，客户需求商务简约风，以皓影为主题，突出产品的价值定位及车型特点。")]),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:6}},[t._v("附件：")]),t._v(" "),a("el-col",{attrs:{span:18}},[a("div",{staticClass:"smname"},[a("img",{attrs:{src:"static/images/document/ppt.png",width:"24",alt:"",srcset:""}}),t._v(" "),a("br"),t._v("参考资料\n            ")])]),t._v(" "),a("el-divider",{attrs:{"content-position":"right"}}),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:6}},[t._v("完成结果：")]),t._v(" "),a("el-col",{attrs:{span:18}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入内容"},model:{value:t.result,callback:function(e){t.result=e},expression:"result"}},[t._v("完成结果：描述")])],1),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:6}},[t._v("附件：")]),t._v(" "),a("el-col",{attrs:{span:18}},[a("div",{staticClass:"smname"},[a("img",{attrs:{src:"static/images/document/ppt.png",width:"24",alt:"",srcset:""}}),t._v(" "),a("br"),t._v("最终成果\n            ")])]),t._v(" "),a("el-divider",{attrs:{"content-position":"right"}}),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:6}},[t._v("反馈意见：")]),t._v(" "),a("el-col",{staticClass:"suggest",attrs:{span:18}},[a("el-scrollbar",{staticStyle:{height:"100%"}},t._l(t.suggest_list,function(e){return a("el-col",{key:e.index,staticClass:"suggest_list",attrs:{span:23}},[a("el-col",{staticClass:"time",attrs:{span:12}},[t._v(t._s(e.time))]),t._v(" "),a("el-col",{staticClass:"pop",attrs:{span:12}},[t._v(t._s(e.pop))]),t._v(" "),a("el-col",{staticClass:"content",attrs:{span:24}},[t._v(t._s(e.content))])],1)}),1)],1)],1)],1),t._v(" "),a("el-row",{staticClass:"batton_pa"},[a("el-col",{staticClass:"batton",attrs:{span:12,offset:7}},[a("el-button",{attrs:{size:"small",type:"info"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("完成")])],1)],1)],1),t._v(" "),a("el-drawer",{attrs:{title:"任务",visible:t.drawer2,"with-header":!1},on:{"update:visible":function(e){t.drawer2=e}}},[a("el-row",{staticClass:"feedback"},[a("el-col",{attrs:{span:24}},[a("el-col",{staticClass:"title",attrs:{span:24}},[t._v(t._s(t.drawer2_task))]),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:6}},[t._v("反馈")]),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{type:"textarea",rows:9,placeholder:"请输入内容"},model:{value:t.feedbackContent,callback:function(e){t.feedbackContent=e},expression:"feedbackContent"}})],1)],1),t._v(" "),a("el-col",{staticClass:"batton",attrs:{span:12,offset:7}},[a("el-button",{attrs:{size:"small",type:"info"}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.taskFeedback}},[t._v("提交")])],1)],1)],1),t._v(" "),a("el-drawer",{attrs:{title:"任务",visible:t.drawer3,"with-header":!1},on:{"update:visible":function(e){t.drawer3=e}}},[a("el-row",{staticClass:"feedback"},[a("el-col",{attrs:{span:24}},[a("el-col",{staticClass:"title",attrs:{span:24}},[t._v(t._s(t.drawer3_task))]),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:6}},[t._v("延期原因")]),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{type:"textarea",rows:9,placeholder:"请输入内容"},model:{value:t.result,callback:function(e){t.result=e},expression:"result"}})],1)],1),t._v(" "),a("el-col",{staticClass:"batton",attrs:{span:12,offset:7}},[a("el-button",{attrs:{size:"small",type:"info"}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")(s,l,!1,function(t){a("vUBr")},"data-v-77b96d52",null);e.default=i.exports}});