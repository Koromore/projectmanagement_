webpackJsonp([3],{"58Tz":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s,i=a("mvHQ"),n=a.n(i),r=a("bOdI"),l=a.n(r),o={name:"project",props:{update:Number,allBusinessList:Array,allClientIdList:Array,userclientIdList:Array,clickCloseNum:Number},data:function(){var t;return t={userId:this.$store.state.user.userId,proId:"",loading:!1,clientIdList:this.$store.state.clientIdList,clientId:"",serviceId:"",isUsual:"",status:"",drawer1:!1,drawer2:!1,drawer3:!1,drawer4:!1,drawer1_name:"",drawer3_name:"任务名称",autofocus:!0,loginState:!0,project_style:"",checkList:[],business_type_list:[],deptList:[],projectData:{},feedbackFileList:[]},l()(t,"business_type_list",[{value:"业务类型1",label:"业务类型1",children:[{value:"客户1",label:"客户1"},{value:"客户1",label:"客户1"}]},{value:"业务类型2",label:"业务类型2",children:[{value:"客户1",label:"客户1"},{value:"客户2",label:"客户2"}]},{value:"业务类型3",label:"业务类型3",children:[{value:"客户1",label:"客户1"},{value:"客户2",label:"客户2"}]}]),l()(t,"client_list",[]),l()(t,"client","广汽本田"),l()(t,"businessList",this.$store.state.businessList),l()(t,"moreShow",!1),l()(t,"projectListOriginate",[]),l()(t,"initiateProjectListTota",[]),l()(t,"projectListJoin",[]),l()(t,"participateProjectListTota",[]),l()(t,"tabs_activity",this.$store.state.projectListNum),l()(t,"tab1_act",""),l()(t,"tab2_act",""),l()(t,"feedbackObj",{feedbackId:"",taskId:"",initUserId:""}),l()(t,"feedbackContent",""),l()(t,"disabled0",!0),l()(t,"projectTaskLisInit",[]),l()(t,"deptNameList",[]),l()(t,"taskNameList",[]),l()(t,"taskNameListShow",[]),l()(t,"checkListDept",[]),l()(t,"checkListTask",[]),l()(t,"add_list",""),l()(t,"checkList1",[]),l()(t,"dialogImageUrl",""),l()(t,"dialogVisible",!1),l()(t,"disabled",!1),l()(t,"delayReason",""),l()(t,"pageNum",this.$store.state.projectPageNum),l()(t,"totalnum",0),l()(t,"currentData",[]),l()(t,"pageNum_",this.$store.state.projectPageNum_),l()(t,"totalnum_",0),l()(t,"currentData_",[]),l()(t,"principalData",[{realName:"姓名",userId:0,projectId:0,deleteFlag:0,id:0}]),l()(t,"putinPrincipalData",[]),l()(t,"changeShow",""),l()(t,"principalList",[]),l()(t,"principalValue",""),l()(t,"principalLabel",""),l()(t,"principalProId",""),l()(t,"add_list",""),l()(t,"dynamicTags",[]),l()(t,"userList",[]),l()(t,"knowUser",[]),t},watch:{principalValue:function(t,e){var a=this,s=this.principalList;""!=t&&s.forEach(function(e){e.value==t&&(a.principalLabel=e.label)})},checkListDept:function(t,e){for(var a=[],s=this.checkListDept,i=this.taskNameList,n=0;n<s.length;n++){for(var r=s[n],l=[],o=0;o<i.length;o++){var c=i[o],p={};c.deptId==r&&(p=c,l.push(p))}a=a.concat(l)}this.taskNameListShow=a},clientId:function(t,e){var a=this.tabs_activity;this.findProjectList(a)},serviceId:function(t,e){var a=this.tabs_activity;this.findProjectList(a)},isUsual:function(t,e){var a=this.tabs_activity;this.findProjectList(a)},status:function(t,e){var a=this.tabs_activity;this.findProjectList(a)},update:function(t,e){this.getProjectList(0)},tabs_activity:function(t,e){var a=this.tabs_activity;this.findProjectList(a)},clickCloseNum:function(t,e){this.moreShow=!1}},mounted:function(){this.projectListNum(),152==this.userId&&(this.tabs_activity=0);var t=this.tabs_activity;this.findProjectList(t),this.getParams(t),this.getListAjax()},methods:(s={formatData2:function(t){var e=t.getFullYear(),a=t.getMonth()+1,s=t.getDate(),i=t.getHours(),n=t.getMinutes(),r=t.getSeconds();return a>=1&&a<=9&&(a="0"+a),s>=0&&s<=9&&(s="0"+s),i>=0&&i<=9&&(i="0"+i),n>=0&&n<=9&&(n="0"+n),r>=0&&r<=9&&(r="0"+r),e+"-"+a+"-"+s+" "+i+":"+n+":"+r},listUniq:function(t,e){for(var a=[t[0]],s=1;s<t.length;s++){for(var i=t[s],n=!1,r=0;r<a.length;r++)if(i[e]==a[r][e]){n=!0;break}n||a.push(i)}return a},projectListNum:function(){this.tabs_activity=this.$store.state.projectListNum},handleChange:function(t){},showInput:function(){var t=this.new_project.dynamicTags,e=this.add_list,a=this.userList,s=!0;if(""!=e){for(var i="",n=0;n<a.length;n++){var r=a[n];r.value==e&&(i=r.label)}for(var l=0;l<t.length;l++){t[l]==i&&(this.messageWarning("请勿重复添加"),s=!1)}s&&(t.push(i),this.add_list="")}else""==e&&this.messageWarning("信息为空")},handleClose:function(t){this.new_project.dynamicTags.splice(this.new_project.dynamicTags.indexOf(t),1)},handleRemoveFeedback:function(t,e){for(var a=this.feedbackFileList,s=t.response.data,i=0;i<a.length;i++){a[i].localPath==s.path&&a.splice(i,1)}this.feedbackFileList=a,0==e.length?this.disabled0=!0:this.disabled0=!1},handleSuccessFeedback:function(t,e,a){var s=t.data,i=this.feedbackFileList,n=new Date,r={createTime:n,deleteFlag:!1,feedbackId:"",fileId:"",fileName:s.fileName,localPath:s.path,suffix:s.fileType,taskId:"",updateTime:n};i.push(r),0==a.length?this.disabled0=!0:this.disabled0=!1},exceed:function(){this.messageWarning("只能上传一个文件")},feedbackClose:function(){this.$refs.feedbackUpload.clearFiles(),this.feedbackFileList=[],this.feedbackContent="",this.checkListDept=[],this.checkListTask=[]},widthheight:function(){window.innerWidth,window.innerHeight},tab1_change:function(t){var e=this.serviceId;this.serviceId=e==t?"":t},tab1_more:function(t){var e=this.moreShow;this.moreShow=!e},tab2_change:function(t,e){this.isUsual===e?(this.tab2_act="",this.isUsual=""):1==t?(this.tab2_act=1,this.isUsual=e):2==t&&(this.tab2_act=2,this.isUsual=e)},tab3_change:function(t){var e=this.status;this.status=e==t?"":t},table_tab:function(t){this.pageNum=1,this.pageNum_=1,this.tabs_activity=t,this.$store.commit("projectListShow",t)},feedback:function(t,e){this.drawer1=!0,this.drawer1_name=e,this.proId=t;var a="?proId="+t+"&userId="+this.userId;this.getProjectTaskListInit(a),0!=this.feedbackFileList.length&&(this.$refs.feedbackUpload.clearFiles(),this.feedbackFileList=[])},aredact:function(t){this.$emit("getData",t)},delayAchieve:function(){var t=this.proId,e=this.formatData2(new Date),a={proId:t,status:5,delayReason:this.delayReason,overTime:e};""==a.delayReason?this.messageError("带*信息不能为空"):(this.drawer3=!1,this.getProjectSave(a))},achieve:function(t){var e=this;this.proId=t.proId,new Date(new Date(t.expertTime).getTime()+864e5)<new Date?(this.drawer3=!0,this.drawer3_name=t.proName):this.$confirm("是否确认此操作？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then(function(){var a=e.formatData2(new Date),s={proId:t.proId,status:3,overTime:a};e.getProjectSave(s)}).catch(function(t){e.$message({type:"info",message:"已取消"})})},getProjectSave:function(t){this.$axios.post("/pmbs/api/project/save",t).then(this.getProjectSaveSuss)},getProjectSaveSuss:function(t){var e=t.data.data;200==t.status&&(3!=e.status&&5!=e.status||this.messageWin("项目已完成"),this.getProjectList(0))},expurgate:function(t){var e=this;this.$confirm("是否确认此操作？","确认信息",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}).then(function(){e.delProject(t)}).catch(function(){e.$message({type:"info",message:"已取消"})})},getProjectTaskListInit:function(t){this.$axios.post("/pmbs/api/project/projectOfTask"+t).then(this.getProjectTaskListInitSuss)},getProjectTaskListInitSuss:function(t){if(200==t.status){var e=t.data.data;this.projectTaskLisInit=e;for(var a=[],s=[],i=0;i<e.length;i++){var n=e[i],r={deptId:n.deptId,deptName:n.deptName},l={deptId:n.deptId,deptName:n.deptName,taskId:n.taskId,taskName:n.taskName};s.push(l),a.push(r)}a=this.listUniq(a,"deptId"),this.deptNameList=a,this.taskNameList=s}},projectFeedback:function(){for(var t=new Date,e=this.checkListTask.join(","),a=this.feedbackFileList,s=0;s<a.length;s++){a[s];a[s].taskId=e}var i={feedback:this.feedbackContent,feedbackFileList:a,initUserId:this.userId,proId:this.proId,moreTaskId:e,updateTime:t};""==i.feedback||""==i.moreTaskId?this.messageError("带*信息不能为空"):this.$axios.post("/pmbs/api/project/projectFeedback",i).then(this.projectFeedbackSuss)},projectFeedbackSuss:function(t){200==t.status&&(this.messageWin("反馈成功"),this.drawer1=!1,this.feedbackContent="",this.taskFeedbackId="",this.getProjectList(0))},delProject:function(t){var e="?projectId="+t;this.$axios.post("/pmbs/api/project/delProject"+e).then(this.delProjectSuss)},delProjectSuss:function(t){200==t.status&&(this.messageWin("项目删除成功"),this.getProjectList(0))},pathPrpjectDetails:function(t,e){var a="";0==e?(a=this.pageNum,this.$store.commit("projectPageNumRecord",a)):1==e&&(a=this.pageNum_,this.$store.commit("projectPageNumRecord_",a)),this.$router.push({path:"/home/components/project_details",query:{id:t,type:e}})},findProjectList:function(t){var e=this.userId,a=this.clientId,s=this.serviceId,i=this.isUsual,n=this.status,r="&clientId="+a,l="&serviceId="+s,o="&isUsual="+i,c="&status="+n;""==a&&(r=""),""==s&&(l=""),""===i&&(o=""),""==n&&(c="");var p="?inituserid="+e+r+l+o+c;0==t?this.getProjectListAjax(p):1==t&&this.getProjectUserjoinproject(p)},getProjectList:function(t){var e=this.userId,a="?inituserid="+e;0==t?this.getProjectListAjax(a):1==t&&this.getProjectUserjoinproject(a)},getProjectListAjax:function(t){this.loading=!0,this.$axios.post("/pmbs/api/project/listAjax"+t).then(this.getProjectListAjaxSuss)},getProjectListAjaxSuss:function(t){if(this.loading=!1,200==t.status){for(var e=t.data.data,a=0;a<e.length;a++){for(var s=e[a],i=0,r=0;r<s.listTask.length;r++){var l=s.listTask[r];3!=l.status&&5!=l.status&&1!=l.isIgnore&&i++}e[a].unfintask=i}this.projectListOriginate=e,this.totalnum=this.projectListOriginate.length;var o=JSON.parse(n()(this.projectListOriginate));this.currentData=o.splice(30*(this.pageNum-1),30*(this.pageNum-1)+30)}},getProjectUserjoinproject:function(t){this.loading=!0,this.$axios.post("/pmbs/api/project/userjoinproject"+t).then(this.getProjectUserjoinprojectSuss)},getProjectUserjoinprojectSuss:function(t){if(this.loading=!1,200==t.status){var e=t.data.data;this.projectListJoin=e,this.totalnum_=this.projectListJoin.length;var a=JSON.parse(n()(this.projectListJoin));this.currentData_=a.splice(30*(this.pageNum_-1),30*(this.pageNum_-1)+30)}},handleSizeChange:function(){},handleCurrentChange:function(t){this.pageNum=t,this.totalnum=this.projectListOriginate.length;var e=JSON.parse(n()(this.projectListOriginate));this.currentData=e.splice(30*(this.pageNum-1),30*(this.pageNum-1)+30)},handleSizeChange_:function(){},handleCurrentChange_:function(t){this.pageNum_=t,this.totalnum_=this.projectListJoin.length;var e=JSON.parse(n()(this.projectListJoin));this.currentData_=e.splice(30*(this.pageNum_-1),30*(this.pageNum_-1)+30)},getParams:function(t){var e=this,a=this.$route.query.name;this.userclientIdList.forEach(function(t){a==t.label&&(e.clientId=t.value)})},getListAjax:function(t){if(0==this.userList.length){this.$axios.post("/pmbs/api/user/list",{pageNum:1}).then(this.getListAjaxSuss)}},getListAjaxSuss:function(t){if(200==t.status){for(var e=t.data.data,a=[],s=0;s<e.length;s++){var i={},n=e[s];i.value=n.userId,i.label=n.deptName+"-"+n.realName,a.push(i)}this.userList=a}},openPrincipal:function(t){this.drawer4=!0,this.principalProId=t,this.getPrincipalList(),this.principalData[0].projectId=t},getPrincipalList:function(){var t=this,e="proId="+this.principalProId+"&userId="+this.userId;this.$axios.post("/pmbs/api/project/Implementset?"+e).then(function(e){if(200==e.status){var a=e.data.data,s=a.listUser,i=a.listBear,n=a.listKnowUser,r=[];0!=i.length?(i.forEach(function(t){var e={projectId:t.projectId,userId:t.userId,realName:t.realName,id:t.id,deleteFlag:3};r.push(e)}),t.principalData=r):0==i.length&&(t.changeShow=0);var l=[];s.forEach(function(t){var e={value:t.userId,label:t.realName};l.push(e)}),t.principalList=l,console.log(t.principalData);var o=[];n.forEach(function(t){var e=t.deptName+"-"+t.realName;o.push(e)}),t.dynamicTags=o}})},principalPull:function(){for(var t=this.userList,e=this.dynamicTags,a=[],s=0;s<e.length;s++){for(var i=e[s],r="",l=0;l<t.length;l++){var o=t[l];i==o.label&&(r=o.value)}a.push(r)}console.log(a);var c=a.join(","),p={proId:this.principalProId,bearUserIds:n()(this.principalData),knowUserIds:c},u=new FormData;u.append("proId",p.proId),u.append("bearUserIds",p.bearUserIds),u.append("knowUserIds",p.knowUserIds),this.$axios.post("/pmbs/api/project/ImplementsetSave",u).then(function(t){console.log(t)})},addPrincipal:function(t){var e=this.principalData,a={realName:"",userId:"",projectId:this.principalProId,deleteFlag:0};e.push(a),this.principalData=e,this.changeShow=t+1},deletePrincipal:function(t,e){var a=this.principalData;this.putinPrincipalData;a[t].deleteFlag=1,console.log(e)},changePrincipal:function(t,e){var a=this.principalData;0!=e.userId&&(a[t].deleteFlag=2),this.changeShow=t},affirmPrincipal:function(t,e){var a=this.principalData,s=this.principalValue,i=this.principalLabel;""==s?(this.changeShow="",2==a[t].deleteFlag&&(a[t].deleteFlag=3)):(a[t].realName=i,a[t].userId=s,this.changeShow="",this.principalValue=""),console.log(this.principalData)},closePrincipal:function(){this.principalData=[{realName:"姓名",userId:0,projectId:0,deleteFlag:0,id:0}],this.putinPrincipalData=[]}},l()(s,"showInput",function(){var t=this.dynamicTags,e=this.add_list,a=this.userList,s=!0;if(""!=e){for(var i="",n=0;n<a.length;n++){var r=a[n];r.value==e&&(i=r.label)}for(var l=0;l<t.length;l++){t[l]==i&&(this.messageWarning("请勿重复添加"),s=!1)}s&&(t.push(i),this.add_list="")}else""==e&&this.messageWarning("信息为空")}),l()(s,"handleClose",function(t){this.dynamicTags.splice(this.dynamicTags.indexOf(t),1)}),l()(s,"empty",function(){this.drawer1=!1,this.drawer2=!1,this.drawer3=!1,this.drawer4=!1,this.feedbackContent="",this.result=""}),l()(s,"messageWin",function(t){this.$message({message:t,type:"success"})}),l()(s,"messageWarning",function(t){this.$message({message:t,type:"warning"})}),l()(s,"messageError",function(t){this.$message.error(t)}),s)},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"project",style:t.project_style},[a("el-row",[a("el-col",{staticClass:"top",attrs:{span:24}},[a("el-col",{attrs:{span:5}},[a("el-col",{staticClass:"title",attrs:{span:4}},[t._v("客户")]),t._v(" "),a("el-col",{attrs:{span:20}},[a("el-select",{staticClass:"filtrateClient",attrs:{filterable:"",clearable:"",placeholder:"全部",size:"small"},model:{value:t.clientId,callback:function(e){t.clientId=e},expression:"clientId"}},t._l(t.userclientIdList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)],1),t._v(" "),a("el-col",{staticClass:"tab tab1",attrs:{span:7}},[a("el-button-group",[t._l(t.allBusinessList[0],function(e,s){return a("el-button",{key:s,class:[t.serviceId==e.businessId?"act":""],attrs:{type:"primary",plain:"",size:"small"},on:{click:function(a){return t.tab1_change(e.businessId)}}},[t._v(t._s(e.businessName))])}),t._v(" "),t.allBusinessList[1]?a("el-button",{class:[1==t.moreShow?"act more":"more"],staticStyle:{"border-left":"0"},attrs:{type:"primary",plain:"",size:"small",icon:"el-icon-more"},on:{click:function(e){return e.stopPropagation(),t.tab1_more()}}}):t._e()],2),t._v(" "),a("el-card",{directives:[{name:"show",rawName:"v-show",value:t.moreShow,expression:"moreShow"}],staticClass:"box-card"},t._l(t.allBusinessList,function(e,s){return a("el-button-group",{directives:[{name:"show",rawName:"v-show",value:0!=s,expression:"index != 0"}],key:s,staticClass:"moreBus"},t._l(e,function(e,s){return a("el-button",{key:s,class:[t.serviceId==e.businessId?"act":""],attrs:{type:"primary",plain:"",size:"small"},on:{click:function(a){return a.stopPropagation(),t.tab1_change(e.businessId)}}},[t._v(t._s(e.businessName))])}),1)}),1)],1),t._v(" "),a("el-col",{staticClass:"tab tab2",attrs:{span:4}},[a("el-button-group",[a("el-button",{class:["1"==t.tab2_act?"act":""],attrs:{type:"primary",plain:"",size:"small"},on:{click:function(e){return t.tab2_change(1,1)}}},[t._v("专项")]),t._v(" "),a("el-button",{class:["2"==t.tab2_act?"act":""],attrs:{type:"primary",plain:"",size:"small"},on:{click:function(e){return t.tab2_change(2,0)}}},[t._v("日常")])],1)],1),t._v(" "),a("el-col",{staticClass:"tab tab3",attrs:{span:8}},[a("el-button-group",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.tab3_change(1)}}},[t._v("新项目")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(e){return t.tab3_change(4)}}},[t._v("延期")]),t._v(" "),a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(e){return t.tab3_change(2)}}},[t._v("审核中")]),t._v(" "),a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(e){return t.tab3_change(1)}}},[t._v("执行中")])],1)],1)],1),t._v(" "),152!=t.userId?a("el-col",{staticClass:"tabs",attrs:{span:24}},[a("div",{class:[1==t.tabs_activity?"act":""],on:{click:function(e){return t.table_tab(1)}}},[t._v("我参与")]),t._v(" "),a("div",{class:[0==t.tabs_activity?"act":""],on:{click:function(e){return t.table_tab(0)}}},[t._v("我发起")])]):t._e(),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:1==t.tabs_activity,expression:"tabs_activity == 1"}],staticClass:"table table2",attrs:{span:24}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"filterTable",staticStyle:{width:"100%"},attrs:{data:t.currentData_,"header-cell-style":{background:"rgb(236, 235, 235)",color:"#000"}}},[a("el-table-column",{attrs:{prop:"name",label:"项目名称","show-overflow-tooltip":"","min-width":"270"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{attrs:{type:"primary"},nativeOn:{click:function(a){return t.pathPrpjectDetails(e.row.proId,1)}}},[t._v(t._s(e.row.proName))]),t._v(" "),e.row.manager==t.userId?a("el-badge",{staticClass:"mark",attrs:{value:"经"}}):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"pasproName",label:"所属立项","show-overflow-tooltip":"","min-width":"270"}}),t._v(" "),a("el-table-column",{attrs:{prop:"state_text",label:"状态","min-width":"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("span",{staticClass:"state_color1"},[t._v("执行中")]):2==e.row.status?a("span",{staticClass:"state_color2"},[t._v("审核中")]):3==e.row.status?a("span",{staticClass:"state_color3"},[t._v("完成")]):4==e.row.status?a("span",{staticClass:"state_color4"},[t._v("延期")]):5==e.row.status?a("span",{staticClass:"state_color3"},[t._v("延期完成")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"expertTime",label:"预计时间",sortable:"","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.$date(e.row.expertTime)))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"overTime",label:"完成时间",sortable:"","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.$date(e.row.overTime)))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"realName",label:"下达人","filter-placement":"bottom-end","min-width":"81"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"81"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.manager==t.userId?a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(a){return t.openPrincipal(e.row.proId)}}},[t._v("设置")]):t._e()]}}])})],1),t._v(" "),a("div",{staticClass:"paging"},[a("el-pagination",{attrs:{"current-page":t.pageNum_,"page-size":30,layout:"total, prev, pager, next",total:t.totalnum_,background:""},on:{"size-change":t.handleSizeChange_,"current-change":t.handleCurrentChange_}})],1)],1),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:0==t.tabs_activity,expression:"tabs_activity == 0"}],staticClass:"table table1",attrs:{span:24}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"filterTable",staticStyle:{width:"100%"},attrs:{data:t.currentData,"header-cell-style":{background:"rgb(236, 235, 235)",color:"#000"}}},[a("el-table-column",{attrs:{prop:"proName",label:"项目名称","show-overflow-tooltip":"","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return a("el-link",{attrs:{type:"primary"},nativeOn:{click:function(a){return t.pathPrpjectDetails(e.row.proId,0)}}},[t._v(t._s(e.row.proName))])}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"pasproName",label:"所属立项","show-overflow-tooltip":"","min-width":"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("span",{staticClass:"state_color1"},[t._v("执行中")]):2==e.row.status?a("span",{staticClass:"state_color2"},[t._v("审核中")]):3==e.row.status?a("span",{staticClass:"state_color3"},[t._v("完成")]):4==e.row.status?a("span",{staticClass:"state_color4"},[t._v("延期")]):5==e.row.status?a("span",{staticClass:"state_color3"},[t._v("延期完成")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"num",label:"任务数","min-width":"90","class-name":"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.listTask.length)+"/"+t._s(e.row.unfintask))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"expertTime",label:"预计时间",sortable:"","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.$date(e.row.expertTime)))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"overTime",label:"完成时间",sortable:"","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.$date(e.row.overTime)))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"realName",label:"下达人","min-width":"90"}}),t._v(" "),a("el-table-column",{attrs:{prop:"managerName",label:"项目经理","filter-placement":"bottom-end","min-width":"90"}}),t._v(" "),152!=t.userId?a("el-table-column",{attrs:{prop:"tag",label:"操作","min-width":"160","filter-placement":"bottom-end"},scopedSlots:t._u([{key:"default",fn:function(e){return[2==e.row.status?a("el-button",{attrs:{slot:"reference",size:"mini",type:"info"},on:{click:function(a){return t.feedback(e.row.proId,e.row.proName)}},slot:"reference"},[t._v("反馈")]):t._e(),t._v(" "),2==e.row.status?a("el-button",{attrs:{slot:"reference",size:"mini",type:"primary"},on:{click:function(a){return t.achieve(e.row)}},slot:"reference"},[t._v("完成")]):t._e(),t._v(" "),1==e.row.status||4==e.row.status?a("el-button",{attrs:{slot:"reference",size:"mini",type:"info"},on:{click:function(a){return t.aredact(e.row)}},slot:"reference"},[t._v("编辑")]):t._e(),t._v(" "),1==e.row.status||4==e.row.status?a("el-button",{attrs:{slot:"reference",size:"mini",type:"info"},on:{click:function(a){return t.expurgate(e.row.proId)}},slot:"reference"},[t._v("删除")]):t._e()]}}],null,!1,1650746475)}):t._e()],1),t._v(" "),a("div",{staticClass:"paging"},[a("el-pagination",{attrs:{"current-page":t.pageNum,layout:"total, prev, pager, next","page-size":30,total:t.totalnum,background:""},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),a("el-drawer",{attrs:{title:"任务",visible:t.drawer1,"with-header":!1},on:{"update:visible":function(e){t.drawer1=e},close:t.feedbackClose}},[a("el-row",{staticClass:"feedback"},[a("el-col",{staticClass:"content",attrs:{span:24}},[a("el-col",{staticClass:"title",attrs:{span:24}},[t._v(t._s(t.drawer1_name))]),t._v(" "),a("el-col",{staticClass:"title snow",attrs:{span:6}},[t._v("反馈")]),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{type:"textarea",rows:9,placeholder:"请输入内容",maxlength:"300","show-word-limit":""},model:{value:t.feedbackContent,callback:function(e){t.feedbackContent=e},expression:"feedbackContent"}})],1),t._v(" "),a("br"),t._v(" "),a("el-col",{staticClass:"title snow",attrs:{span:6}},[t._v("接受")]),t._v(" "),a("el-col",{attrs:{span:19}},[a("el-checkbox-group",{model:{value:t.checkListDept,callback:function(e){t.checkListDept=e},expression:"checkListDept"}},t._l(t.deptNameList,function(e){return a("el-checkbox",{key:e.deptId,attrs:{label:e.deptId}},[t._v(t._s(e.deptName))])}),1)],1),t._v(" "),a("el-col",{staticClass:"title snow",attrs:{span:6}},[t._v("任务")]),t._v(" "),a("el-col",{attrs:{span:19}},[a("el-checkbox-group",{model:{value:t.checkListTask,callback:function(e){t.checkListTask=e},expression:"checkListTask"}},t._l(t.taskNameListShow,function(e){return a("el-checkbox",{key:e.index,attrs:{label:e.taskId}},[t._v(t._s(e.taskName))])}),1)],1),t._v(" "),a("el-col",{staticClass:"title snow",attrs:{span:6}},[t._v("附件")]),t._v(" "),a("el-col",{staticClass:"Upload",attrs:{span:24}},[a("el-upload",{ref:"feedbackUpload",staticClass:"elementUpload",attrs:{action:"/pmbs/file/upload?upType=0&demandType=1","on-remove":t.handleRemoveFeedback,"on-success":t.handleSuccessFeedback,limit:1,"on-exceed":t.exceed}},[a("el-button",{attrs:{size:"mini",type:"primary"}},[t._v("点击上传文档")])],1)],1)],1),t._v(" "),a("el-col",{staticClass:"batton",attrs:{span:12,offset:7}},[a("el-button",{attrs:{size:"small",type:"info"},on:{click:t.empty}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.projectFeedback}},[t._v("提交")])],1)],1)],1),t._v(" "),a("el-drawer",{attrs:{title:"延期原因",visible:t.drawer3,"with-header":!1},on:{"update:visible":function(e){t.drawer3=e}}},[a("el-row",{staticClass:"feedback"},[a("el-col",{attrs:{span:24}},[a("el-col",{staticClass:"title",attrs:{span:24}},[t._v(t._s(t.drawer3_name))]),t._v(" "),a("el-col",{staticClass:"title snow",attrs:{span:6}},[t._v("延期原因")]),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{type:"textarea",rows:9,placeholder:"请输入内容",maxlength:"300","show-word-limit":""},model:{value:t.delayReason,callback:function(e){t.delayReason=e},expression:"delayReason"}})],1)],1),t._v(" "),a("el-col",{staticClass:"batton",attrs:{span:24}},[a("el-button",{attrs:{size:"small",type:"info"},on:{click:t.empty}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.delayAchieve}},[t._v("提交")])],1)],1)],1),t._v(" "),a("el-drawer",{attrs:{title:"项目担当",visible:t.drawer4,"with-header":!1},on:{"update:visible":function(e){t.drawer4=e},close:t.closePrincipal}},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("el-row",{staticClass:"principal"},[a("el-col",{staticClass:"title",attrs:{span:24}},[t._v("项目担当&知晓人")]),t._v(" "),a("el-col",{staticClass:"key",attrs:{span:6}},[t._v("项目担当:")]),t._v(" "),a("el-col",{staticClass:"value prin",attrs:{span:18}},[a("div",{staticClass:"pixi-item"},[a("div",{staticClass:"title-left"},[t._v("名称")]),t._v(" "),a("div",{staticClass:"title-right"},[t._v("操作")])]),t._v(" "),t._l(t.principalData,function(e,s){return a("div",{directives:[{name:"show",rawName:"v-show",value:1!=e.deleteFlag,expression:"item.deleteFlag != 1"}],key:s,staticClass:"pixi-item"},[a("div",{staticClass:"title-left"},[t.changeShow===s?a("div",{staticClass:"change"},[a("el-select",{staticStyle:{width:"99px"},attrs:{filterable:"",placeholder:"请选择",clearable:"",size:"small"},model:{value:t.principalValue,callback:function(e){t.principalValue=e},expression:"principalValue"}},t._l(t.principalList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.affirmPrincipal(s,e)}}},[t._v("确认")])],1):a("div",{staticClass:"name"},[t._v(t._s(e.realName))])]),t._v(" "),a("div",{staticClass:"title-right"},[a("el-link",{attrs:{type:"primary"},on:{click:function(a){return t.changePrincipal(s,e)}}},[t._v("更换")]),t._v(" "),a("el-link",{attrs:{type:"primary"},on:{click:function(a){return t.deletePrincipal(s,e)}}},[t._v("删除")]),t._v(" "),s==t.principalData.length-1?a("i",{staticClass:"el-icon-circle-plus-outline add",on:{click:function(e){return t.addPrincipal(s)}}}):t._e()],1)])})],2),t._v(" "),a("el-col",{staticClass:"key",attrs:{span:6}},[t._v("知晓人:")]),t._v(" "),a("el-col",{staticClass:"value know",attrs:{span:18}},[a("el-col",{attrs:{span:18}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择",size:"small"},model:{value:t.add_list,callback:function(e){t.add_list=e},expression:"add_list"}},t._l(t.userList,function(t){return a("el-option",{key:t.index,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.showInput}},[t._v("添加")])],1),t._v(" "),a("el-col",{staticClass:"know_pop",attrs:{span:24}},t._l(t.dynamicTags,function(e){return a("el-tag",{key:e.index,staticClass:"know_pop_list",attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return t.handleClose(e)}}},[t._v(t._s(e))])}),1)],1)],1)],1),t._v(" "),a("el-col",{staticClass:"batton pribatton",attrs:{span:24}},[a("el-button",{attrs:{size:"small",type:"info"},on:{click:t.empty}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.principalPull}},[t._v("提交")])],1)],1)],1)],1)},staticRenderFns:[]};var p=a("VU/8")(o,c,!1,function(t){a("FGXa")},"data-v-46110281",null);e.default=p.exports},FGXa:function(t,e){}});